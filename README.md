# MSTC Cloud Worker
This project provides a Worker that consumes work requests from a queue, submits Kubernetes jobs and writes responses back.

## Overview


## Deploying RabbitMQ and MinIO
We'll need to deploy both RabbitMQ and MinIO to Kubernetes.

### RabbitMQ
The RabbitMQ Helm chart is downloaded from the Bitnami Helm repository at:

`https://charts.bitnami.com/bitnami`

Adding the Bitnami Helm repository as a resource is required, run the following command:

`helm repo add bitnami https://charts.bitnami.com/bitnami`

To install RabbitMQ, run the following command:

`helm install rabbitmq bitnami/rabbitmq --set auth.username=user --set auth.password=password --persistence.enabled=false`


The following will be printed out:

```
Credentials:
    echo "Username      : user"
    echo "Password      : $(kubectl get secret --namespace default rabbitmq -o jsonpath="{.data.rabbitmq-password}" | base64 --decode)"
    echo "ErLang Cookie : $(kubectl get secret --namespace default rabbitmq -o jsonpath="{.data.rabbitmq-erlang-cookie}" | base64 --decode)"

Note that the credentials are saved in persistent volume claims and will not be changed upon upgrade or reinstallation unless the persistent volume claim has been deleted. If this is not the first installation of this chart, the credentials may not be valid.
This is applicable when no passwords are set and therefore the random password is autogenerated. In case of using a fixed password, you should specify it when upgrading.
More information about the credentials may be found at https://docs.bitnami.com/general/how-to/troubleshoot-helm-chart-issues/#credential-errors-while-upgrading-chart-releases.

RabbitMQ can be accessed within the cluster on port  at rabbitmq.default.svc.

To access for outside the cluster, perform the following steps:

To Access the RabbitMQ AMQP port:

    echo "URL : amqp://127.0.0.1:5672/"
    kubectl port-forward --namespace default svc/rabbitmq 5672:5672

To Access the RabbitMQ Management interface:

    echo "URL : http://127.0.0.1:15672/"
    kubectl port-forward --namespace default svc/rabbitmq 15672:15672

```

To uninstall the deployment run:

`helm uninstall rabbitmq`

### MinIO
The MinIO chart was downloaded from...

